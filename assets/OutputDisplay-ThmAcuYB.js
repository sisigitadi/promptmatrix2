import{r as o,j as e,aS as ae,aT as Me,aU as Oe,aV as Re,aM as Ae,af as Q,aW as Be,aj as ee,a8 as _e,Y as Ee,aX as Fe,aY as Ge,aZ as Ke}from"./vendor-CpGgheO9.js";import{c as Ie}from"./api-CtCCZrik.js";import{M as d,F as i,I as $e,B as n,R as Ue,a as I,S as se,e as ze,b as M,f as $}from"./bootstrap-vendor-DaD4giyc.js";import{y as He}from"./toastify-vendor-BS7qYPjn.js";import{e as U}from"./promptGenerators-KF_6FwiQ.js";import{P as Le}from"./index-Dh5SxBWa.js";import"./gemini-vendor-CZZ1HbHH.js";const Je=({show:h,onHide:j,selectedModel:g,onModelSelect:S,apiKey:v,setApiKey:r,isApiKeyEnabled:l,formData:c,handleInputChangeWithValidation:p,validationErrors:b})=>{const[k,y]=o.useState(!1);return e.jsxs(d,{show:h,onHide:j,centered:!0,dialogClassName:"modal-themed",size:"lg",children:[e.jsx(d.Header,{closeButton:!0,className:"modal-header-themed border-bottom-0",children:e.jsxs(d.Title,{className:"d-flex align-items-center gap-2 text-info",children:[e.jsx(ae,{})," Pengaturan Mode Pengembang"]})}),e.jsx(d.Body,{className:"modal-body-themed p-4",children:e.jsxs(i,{children:[e.jsxs("div",{className:"mb-4 p-3 bg-dark-subtle rounded border border-secondary",children:[e.jsxs("h6",{className:"text-info mb-3 d-flex align-items-center gap-2 small text-uppercase fw-bold",children:[e.jsx(Me,{size:14})," Konfigurasi API"]}),e.jsxs(i.Group,{className:"mb-3",children:[e.jsx(i.Label,{className:"small text-muted mb-1",children:"Model Gemini Target"}),e.jsxs(i.Select,{value:g,onChange:u=>S(u.target.value),className:"bg-dark text-light border-secondary",children:[e.jsx("option",{value:"gemini-3.0-pro",children:"gemini-3.0-pro"}),e.jsx("option",{value:"gemini-2.0-flash-exp",children:"gemini-2.0-flash-exp"}),e.jsx("option",{value:"gemini-1.5-pro",children:"gemini-1.5-pro"}),e.jsx("option",{value:"gemini-1.5-flash",children:"gemini-1.5-flash"}),e.jsx("option",{value:"gemini-1.5-pro-002",children:"gemini-1.5-pro-002"}),e.jsx("option",{value:"gemini-1.5-flash-002",children:"gemini-1.5-flash-002"}),e.jsx("option",{value:"gemini-1.5-flash-8b",children:"gemini-1.5-flash-8b"}),e.jsx("option",{value:"gemini-1.0-pro",children:"gemini-1.0-pro"})]})]}),e.jsxs(i.Group,{children:[e.jsx(i.Label,{className:"small text-muted mb-1",children:"Google API Key"}),e.jsxs($e,{children:[e.jsx(i.Control,{type:k?"text":"password",placeholder:"Masukkan API Key Anda...",value:v,onChange:u=>r(u.target.value),className:"bg-dark text-light border-secondary"}),e.jsx(n,{variant:"outline-secondary",className:"border-secondary",onClick:()=>y(u=>!u),children:k?e.jsx(Oe,{}):e.jsx(Re,{})})]}),e.jsx("div",{className:"mt-2 p-2 bg-dark rounded border border-warning border-opacity-25",children:e.jsxs("p",{className:"small text-warning mb-0",style:{fontSize:"0.75rem"},children:[e.jsx("strong",{children:"Keamanan:"})," API Key disimpan di"," ",e.jsx("code",{children:"sessionStorage"}),". Kunci akan dihapus saat tab browser ditutup. Jangan gunakan kunci produksi dengan kuota tinggi."]})})]})]}),e.jsxs("div",{className:"p-3 bg-dark-subtle rounded border border-secondary",children:[e.jsxs("h6",{className:"text-info mb-3 d-flex align-items-center gap-2 small text-uppercase fw-bold",children:[e.jsx(Ae,{size:14})," Parameter Generasi"]}),e.jsxs(Ue,{className:"g-3",children:[e.jsx(I,{md:4,children:e.jsxs(i.Group,{children:[e.jsx(i.Label,{className:"small text-muted mb-1",children:"Temperature"}),e.jsx(i.Control,{type:"number",step:"0.1",min:"0",max:"1",placeholder:"0.7",value:c.temperature||"",onChange:u=>p("temperature",parseFloat(u.target.value),{validation:{min_value:0,max_value:1}}),isInvalid:!!b.temperature,className:"bg-dark text-light border-secondary"}),e.jsx(i.Control.Feedback,{type:"invalid",children:b.temperature})]})}),e.jsx(I,{md:4,children:e.jsxs(i.Group,{children:[e.jsx(i.Label,{className:"small text-muted mb-1",children:"Top P"}),e.jsx(i.Control,{type:"number",step:"0.1",min:"0",max:"1",placeholder:"0.9",value:c.top_p||"",onChange:u=>p("top_p",parseFloat(u.target.value),{validation:{min_value:0,max_value:1}}),isInvalid:!!b.top_p,className:"bg-dark text-light border-secondary"}),e.jsx(i.Control.Feedback,{type:"invalid",children:b.top_p})]})}),e.jsx(I,{md:4,children:e.jsxs(i.Group,{children:[e.jsx(i.Label,{className:"small text-muted mb-1",children:"Top K"}),e.jsx(i.Control,{type:"number",min:"1",placeholder:"40",value:c.top_k||"",onChange:u=>p("top_k",parseInt(u.target.value),{validation:{min_value:1}}),isInvalid:!!b.top_k,className:"bg-dark text-light border-secondary"}),e.jsx(i.Control.Feedback,{type:"invalid",children:b.top_k})]})})]})]})]})}),e.jsx(d.Footer,{className:"modal-footer-themed bg-dark border-top border-secondary mt-0",children:e.jsx(n,{variant:"primary",onClick:j,className:"px-5",children:"Simpan & Tutup"})})]})},Ye=({show:h,onHide:j,aiResponse:g,aiError:S,isGenerating:v})=>{const r=()=>{if(!g)return;const l=g.replace(/\r\n/g,`
`).replace(/\r/g,`
`);navigator.clipboard.writeText(l),He.info("Respons AI disalin!")};return e.jsxs(d,{show:h,onHide:j,centered:!0,size:"lg",scrollable:!0,dialogClassName:"modal-themed",children:[e.jsx(d.Header,{closeButton:!0,className:"modal-header-themed border-bottom-0",children:e.jsxs(d.Title,{className:"d-flex align-items-center gap-2 text-info",children:[e.jsx(Q,{})," Respons AI"]})}),e.jsx(d.Body,{className:"modal-body-themed p-0",children:e.jsx("div",{className:"p-4",children:v?e.jsxs("div",{className:"text-center py-5",children:[e.jsx(se,{animation:"grow",variant:"info",className:"mb-3"}),e.jsx("h5",{className:"text-info",children:"AI Sedang Berpikir..."}),e.jsx("p",{className:"text-muted small",children:"Harap tunggu sebentar, kami sedang menyusun prompt Anda."})]}):S?e.jsxs(ze,{variant:"danger",className:"d-flex align-items-start gap-3 bg-dark border-danger text-danger",children:[e.jsx(Be,{size:24,className:"mt-1"}),e.jsxs("div",{children:[e.jsx("h6",{className:"fw-bold",children:"Terjadi Kesalahan"}),e.jsx("p",{className:"mb-0 small",children:S})]})]}):g?e.jsxs("div",{className:"ai-response-wrapper border border-secondary rounded overflow-hidden",children:[e.jsxs("div",{className:"p-3 bg-dark-subtle border-bottom border-secondary d-flex justify-content-between align-items-center",children:[e.jsx("span",{className:"small text-muted text-uppercase fw-bold letter-spacing-1",children:"Markdown Output"}),e.jsxs(n,{variant:"outline-info",size:"sm",onClick:r,className:"py-1",children:[e.jsx(ee,{className:"me-1"})," Salin"]})]}),e.jsx("div",{className:"p-4 bg-dark custom-scrollbar",style:{maxHeight:"65vh",overflowY:"auto"},children:e.jsx(_e,{components:{code({node:l,inline:c,className:p,children:b,...k}){const y=/language-(\w+)/.exec(p||"");return!c&&y?e.jsx(Fe,{language:y[1],PreTag:"div",style:{},...k,children:String(b).replace(/\n$/,"")}):e.jsx("code",{className:`${p} bg-secondary px-1 rounded text-info`,...k,children:b})},blockquote({children:l}){return e.jsx("blockquote",{className:"border-start border-4 border-info ps-3 my-3 text-muted fst-italic",children:l})},img({...l}){return e.jsxs("div",{className:"text-center my-4",children:[e.jsx("img",{...l,className:"img-fluid rounded border border-secondary shadow-lg",alt:l.alt||"AI Content"}),!l.src?.startsWith("data:")&&e.jsxs(n,{variant:"link",size:"sm",className:"text-info mt-2",href:l.src,download:!0,children:[e.jsx(Ee,{className:"me-1"})," Unduh Gambar"]})]})}},children:g})})]}):e.jsxs("div",{className:"text-center py-5 text-muted opacity-50",children:[e.jsx(Q,{size:48,className:"mb-3"}),e.jsx("p",{children:"Belum ada respons untuk ditampilkan."})]})})}),e.jsxs(d.Footer,{className:"modal-footer-themed bg-dark border-top border-secondary",children:[e.jsx(n,{variant:"outline-secondary",onClick:j,className:"px-4",children:"Tutup"}),g&&!v&&e.jsxs(n,{variant:"primary",onClick:r,className:"px-4",children:[e.jsx(ee,{className:"me-2"})," Salin Hasil Lengkap"]})]})]})},ea=({naturalLanguageOutput:h,jsonOutput:j,previewNaturalLanguageOutput:g,previewJsonOutput:S,currentFrameworkDetails:v,formData:r,customInputs:l,selectedFramework:c,selectedCategory:p,onUseAsInput:b,onShowSavedPrompts:k,showDevMode:y,onSavePrompt:u,apiKey:O,setApiKey:te,selectedModel:_,onModelSelect:ne,isApiKeyEnabled:z,handleInputChangeWithValidation:re,validationErrors:le,onSelectRecommendedFramework:oe})=>{const[N,H]=o.useState(()=>localStorage.getItem("defaultOutputType")||"natural");o.useEffect(()=>{localStorage.setItem("defaultOutputType",N)},[N]);const[ie,L]=o.useState("Salin"),[de,R]=o.useState(!1),[ce,J]=o.useState(""),[me,A]=o.useState(null),[E,Y]=o.useState(!1),[pe,P]=o.useState(null),[xe,W]=o.useState(!1),[he,q]=o.useState(!1),[ue,F]=o.useState(!1),[je,ge]=o.useState(""),[be,V]=o.useState(!1),fe=Array.isArray(h)?h.length===0:!h&&!j,B=N==="natural"?g:fe?S:j,[w,X]=o.useState(B),[T,Z]=o.useState(!1),G=o.useRef(null);o.useEffect(()=>{X(B),Z(!1),V(!1)},[B]),o.useEffect(()=>{T&&G.current&&G.current.focus()},[T]);const ye=()=>{Z(!T)},ve=a=>{a.stopPropagation();const m=w.replace(/\r\n/g,`
`).replace(/\r/g,`
`);navigator.clipboard.writeText(m).then(()=>{L("Tersalin!"),setTimeout(()=>L("Salin"),2e3)})},ke=()=>{const a=Ke(g.replace(/\r\n/g,`
`),w.replace(/\r\n/g,`
`));let m="";a.forEach(s=>{const x=s.added?"+ ":s.removed?"- ":"  ",t=s.value.split(/\n/);t[t.length-1]===""&&t.pop();for(const C of t)m+=`${x}${C}
`}),ge(m),F(!0)},Ne=async()=>{console.log("handleGenerateClick - API Key Check:",{apiKey:O,isApiKeyEnabled:z,selectedModel:_}),Y(!0),A(null),P(null),q(!0);const a={temperature:r.temperature?parseFloat(r.temperature):void 0,topP:r.top_p?parseFloat(r.top_p):void 0,topK:r.top_k?parseInt(r.top_k):void 0},m=Array.isArray(h)&&h.length>0?h:w;try{const s=await Ie(O,m,_,a);s.error?(P(s.error),A(null)):(A(s),P(null))}catch(s){s.error?P(s.error):s instanceof Error?P(s.message):P("An unknown error occurred."),A(null)}finally{Y(!1)}},we=()=>{if(!v||!c||!p){J("Tidak dapat menyimpan prompt: Detail framework atau kategori tidak lengkap."),R(!0);return}const a={category:p,subcategory:v.framework?.kategori?.[1]||"",frameworkName:c,formData:r,customInputs:l,naturalLanguageOutput:h,jsonOutput:j};u(a),J("Prompt berhasil disimpan!"),R(!0)},Ce=()=>{let a=`# PromptMatrix Export - ${c||"Untitled Prompt"}

`;if(p&&(a+=`**Kategori:** ${p}
`),c&&(a+=`**Kerangka Kerja:** ${c}

`),Object.keys(r).length>0){a+=`## Input Data:
`;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&(a+=`- **${t}:** ${r[t]}
`);a+=`
`}if(Object.keys(l).length>0){a+=`## Custom Inputs:
`;for(const t in l)Object.prototype.hasOwnProperty.call(l,t)&&(a+=`- **${t}:** ${l[t]}
`);a+=`
`}a+=`## Output Prompt:

`,a+=g;const m=new Blob([a],{type:"text/markdown"}),s=URL.createObjectURL(m),x=document.createElement("a");x.href=s,x.download=U(c||"untitled_prompt","md"),document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(s)},Se=()=>{const m=JSON.stringify({framework:c,category:p,inputs:r,customInputs:l,naturalLanguageOutput:h,jsonOutput:j},null,2),s=new Blob([m],{type:"application/json"}),x=URL.createObjectURL(s),t=document.createElement("a");t.href=x,t.download=U(c||"untitled_prompt","json"),document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(x)},Pe=()=>{let a="";a+=["Field","Value"].join(",")+`
`;const s=(f,K)=>{const Te=typeof K=="string"?K:JSON.stringify(K);a+=`"${f.replace(/"/g,"''")}","${Te.replace(/"/g,"''")}"
`};s("Framework",c||""),s("Category",p||"");for(const f in r)Object.prototype.hasOwnProperty.call(r,f)&&s(`Input - ${f}`,r[f]);for(const f in l)Object.prototype.hasOwnProperty.call(l,f)&&s(`Custom Input - ${f}`,l[f]);s("Natural Language Output",h),s("JSON Output",j);const x=new Blob([a],{type:"text/csv"}),t=URL.createObjectURL(x),C=document.createElement("a");C.href=t,C.download=U(c||"untitled_prompt","csv"),document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(t)},D=o.useMemo(()=>{if(!p||!c)return[];const a=[],m=Le[p];if(m){for(const s in m)if(Object.prototype.hasOwnProperty.call(m,s)){const x=m[s];for(const t in x)Object.prototype.hasOwnProperty.call(x,t)&&t!==c&&a.push({name:t,category:p,subcategory:s})}}return a.sort(()=>.5-Math.random()).slice(0,3)},[p,c]);return e.jsxs(e.Fragment,{children:[e.jsxs(M,{className:"flex-grow-1 h-100",children:[e.jsxs(M.Header,{className:"d-flex justify-content-between align-items-center",children:["4. Pratinjau Prompt:",e.jsxs($,{"aria-label":"Output Type",children:[e.jsx(n,{variant:N==="natural"?"primary":"outline-primary",onClick:()=>H("natural"),children:"ðŸ“ Natural"}),e.jsx(n,{variant:N==="json"?"primary":"outline-primary",onClick:()=>H("json"),children:"ðŸ“„ JSON"})]})]}),e.jsx(M.Body,{className:"d-flex flex-column text-start",children:e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsx(i.Control,{as:"textarea",ref:G,value:w,onChange:a=>{X(a.target.value),V(!0)},rows:Math.max(10,(w||"").split(`
`).length+1),className:`flex-grow-1 mb-3 output-textarea ${T?"editable":""} ${N==="json"?"syntax-highlighted":""}`,placeholder:"Prompt Anda yang terstruktur lengkap akan disusun dan ditampilkan di sini...","aria-label":"Output Prompt",readOnly:!T,style:{padding:"clamp(1rem, 2vw, 1.5rem)",fontSize:"clamp(0.85rem, 1.2vw, 1rem)",maxHeight:"60vh",overflowY:"auto",whiteSpace:"pre-wrap",wordBreak:"break-word"}}),N==="natural"&&e.jsxs("div",{className:"d-flex justify-content-end small mb-2",children:[e.jsxs("span",{children:["Karakter: ",w.length]}),e.jsxs("span",{className:"ms-3",children:["Kata:"," ",w.trim().split(/\s+/).filter(Boolean).length]})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-3",children:[e.jsxs($,{className:"flex-grow-1 me-2",children:[" ",e.jsxs(n,{variant:"success",onClick:ve,children:["ðŸ“‹ ",ie]}),e.jsx(n,{variant:"info",onClick:ye,children:T?"Selesai Edit":"âœï¸ Edit"}),be&&e.jsx(n,{variant:"outline-info",onClick:ke,className:"ms-2",children:"â†”ï¸ Bandingkan"})]}),e.jsxs($,{className:"flex-grow-1 me-2",children:[e.jsx(n,{variant:"outline-secondary",onClick:Ce,children:"â¬‡ï¸ MD"}),e.jsx(n,{variant:"outline-secondary",onClick:Se,children:"â¬‡ï¸ JSON"}),e.jsx(n,{variant:"outline-secondary",onClick:Pe,children:"â¬‡ï¸ CSV"})]}),e.jsxs(n,{variant:"warning",onClick:()=>b(B),className:"flex-grow-1",children:["âž¡ï¸ Output ","â†’"," Input"]})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-3",children:[y&&e.jsx(n,{variant:"info",onClick:Ne,className:"flex-grow-1 me-2",disabled:E||!z||!O,children:E?e.jsxs(e.Fragment,{children:[e.jsx(se,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," ","Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ge,{})," Generate AI Response"]})}),y&&e.jsx(n,{variant:"outline-secondary",onClick:()=>W(!0),className:"flex-grow-0",title:"Pengaturan Mode Pengembang","aria-label":"Pengaturan Mode Pengembang",children:e.jsx(ae,{})})]})]}),e.jsxs("div",{style:{flexGrow:1,display:"flex",flexDirection:"column",paddingTop:"1rem",borderTop:"1px solid var(--border-color)"},children:[e.jsx(M.Title,{className:"mb-3",children:"5. Simpan Prompt:"}),e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsx(n,{variant:"primary",onClick:we,className:"flex-grow-1 me-2",children:"ðŸ’¾ Simpan Prompt"}),e.jsx(n,{variant:"info",onClick:k,className:"flex-grow-1",children:"ðŸ“š Prompt Tersimpan"})]})]}),D.length>0&&e.jsxs("div",{style:{flexShrink:0,paddingTop:"1rem",borderTop:"1px solid var(--border-color)",marginTop:"1rem"},children:[e.jsx(M.Title,{className:"mb-3",children:"Rekomendasi Kerangka Kerja Terkait:"}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:D.map(a=>e.jsx(n,{variant:"outline-secondary",size:"sm",onClick:()=>{oe(a.name,a.category,a.subcategory)},children:a.name},a.name))})]})]})})]}),e.jsxs(d,{show:de,onHide:()=>R(!1),centered:!0,dialogClassName:"modal-themed",children:[e.jsx(d.Header,{closeButton:!0,className:"modal-header-themed",children:e.jsx(d.Title,{children:"Notifikasi Penyimpanan"})}),e.jsx(d.Body,{className:"modal-body-themed",children:e.jsx("p",{children:ce})}),e.jsx(d.Footer,{className:"modal-footer-themed",children:e.jsx(n,{variant:"secondary",onClick:()=>R(!1),children:"Tutup"})})]}),y&&e.jsx(Je,{show:xe,onHide:()=>W(!1),selectedModel:_,onModelSelect:ne,apiKey:O,setApiKey:te,formData:r,handleInputChangeWithValidation:re,validationErrors:le}),e.jsx(Ye,{show:he,onHide:()=>q(!1),aiResponse:me,aiError:pe,isGenerating:E}),e.jsxs(d,{show:ue,onHide:()=>F(!1),centered:!0,dialogClassName:"modal-themed",size:"lg",children:[e.jsx(d.Header,{closeButton:!0,className:"modal-header-themed",children:e.jsx(d.Title,{children:"Perbandingan Output"})}),e.jsx(d.Body,{className:"modal-body-themed",children:e.jsx("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",backgroundColor:"#282a36",color:"#f8f8f2",padding:"1rem",borderRadius:"0.25rem"},children:je.split(`
`).map((a,m)=>{const s=a.startsWith("+ ")?"#50fa7b":a.startsWith("- ")?"#ff5555":"inherit";return e.jsx("span",{style:{color:s,display:"block"},children:a},m)})})}),e.jsx(d.Footer,{className:"modal-footer-themed",children:e.jsx(n,{variant:"secondary",onClick:()=>F(!1),children:"Tutup"})})]})]})};export{ea as default};
