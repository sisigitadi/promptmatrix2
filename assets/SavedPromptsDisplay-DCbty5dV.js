import{r as x,j as e,X as y,Y as k,Z,$ as _,a0 as X,a1 as Y,a2 as q,a3 as K,V as w,a4 as F,a5 as Q,a6 as W}from"./vendor-CSLY-SmC.js";import{e as C}from"./promptGenerators-DJ-rJUqy.js";import{y as c}from"./toastify-vendor-Ddy96bbr.js";import{M as d,B as t,F as S,R as ee,a as se,I as ae,c as z,d as te,L as R}from"./bootstrap-vendor-BDZr_8wO.js";const oe=({show:D,onHide:f,savedPrompts:m,onLoadPrompt:p,onDeletePrompt:E,onExportPrompts:B,onImportPrompts:L,onRenamePrompt:I,toggleFavorite:O})=>{const[N,T]=x.useState("dateDesc"),[h,u]=x.useState(null),[j,g]=x.useState(""),[b,V]=x.useState(null),U=s=>{V(b===s?null:s)},A=s=>{u(s),g(s.frameworkName)},P=()=>{h&&j.trim()!==""&&(I(h.id,j.trim()),u(null),g(""),c.success("Nama prompt diperbarui!"))},$=s=>{const a=C(`${s.frameworkName}_${s.id}`,"json"),r=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),n=URL.createObjectURL(r),l=document.createElement("a");l.href=n,l.download=a,l.click(),URL.revokeObjectURL(n),c.info("Prompt diekspor!")},J=()=>{const a=[["id","frameworkName","category","subcategory","latestTimestamp","formData"].join(",")],r=i=>`"${(typeof i=="object"?JSON.stringify(i):String(i)).replace(/"/g,'""')}"`;m.forEach(i=>{const v=i.versions[i.versions.length-1],H=[i.id,i.frameworkName,i.category,i.subcategory,new Date(v.timestamp).toISOString(),r(v.formData)];a.push(H.join(","))});const n=new Blob([a.join(`
`)],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(n),o=document.createElement("a");o.href=l,o.download=C("saved_prompts","csv"),o.click(),URL.revokeObjectURL(l),c.info("Database diekspor ke CSV!")},M=()=>{const s=document.createElement("input");s.type="file",s.accept=".json",s.onchange=a=>{const r=a.target.files?.[0];if(r){const n=new FileReader;n.onload=l=>{try{const o=JSON.parse(l.target?.result);L(o),c.success("Data berhasil diimpor!")}catch(o){console.error("Import error:",o),c.error("Format file tidak valid.")}},n.readAsText(r)}},s.click()},G=[...m].sort((s,a)=>{if(s.isFavorite&&!a.isFavorite)return-1;if(!s.isFavorite&&a.isFavorite)return 1;if(N==="nameAsc")return s.frameworkName.localeCompare(a.frameworkName);const r=s.versions?.[s.versions?.length-1]?.timestamp??0;return(a.versions?.[a.versions?.length-1]?.timestamp??0)-r});return e.jsxs(d,{show:D,onHide:f,centered:!0,size:"xl",scrollable:!0,dialogClassName:"modal-themed",children:[e.jsx(d.Header,{closeButton:!0,className:"modal-header-themed border-bottom-0",children:e.jsxs(d.Title,{className:"d-flex align-items-center gap-2 text-info",children:[e.jsx(y,{})," Prompt Tersimpan & Riwayat"]})}),e.jsxs(d.Body,{className:"modal-body-themed p-0",children:[e.jsxs("div",{className:"p-3 bg-dark border-bottom border-secondary d-flex flex-wrap justify-content-between align-items-center gap-3",children:[e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs(t,{variant:"outline-info",size:"sm",onClick:()=>B(m),children:[e.jsx(k,{className:"me-1"})," Ekspor JSON"]}),e.jsxs(t,{variant:"outline-success",size:"sm",onClick:J,children:[e.jsx(Z,{className:"me-1"})," Ekspor CSV"]}),e.jsxs(t,{variant:"outline-primary",size:"sm",onClick:M,children:[e.jsx(_,{className:"me-1"})," Impor"]})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(X,{className:"text-muted small"}),e.jsxs(S.Select,{size:"sm",value:N,onChange:s=>T(s.target.value),className:"bg-dark text-light border-secondary",style:{width:"160px"},children:[e.jsx("option",{value:"dateDesc",children:"Terbaru"}),e.jsx("option",{value:"nameAsc",children:"Nama (A-Z)"})]})]})]}),e.jsx("div",{className:"p-4",children:m.length===0?e.jsxs("div",{className:"text-center py-5 text-muted opacity-50",children:[e.jsx(y,{size:48,className:"mb-3"}),e.jsx("p",{children:"Belum ada prompt yang disimpan."})]}):e.jsx(ee,{className:"g-3",children:G.map(s=>e.jsx(se,{xs:12,children:e.jsxs("div",{className:`prompt-history-card border rounded p-3 bg-dark-subtle hover-lift ${s.isFavorite?"border-warning":"border-secondary"}`,children:[h?.id===s.id?e.jsxs(ae,{size:"sm",children:[e.jsx(S.Control,{value:j,onChange:a=>g(a.target.value),className:"bg-dark text-light border-info",autoFocus:!0}),e.jsx(t,{variant:"success",onClick:P,children:"Simpan"}),e.jsx(t,{variant:"outline-secondary",onClick:()=>u(null),children:"Batal"})]}):e.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-3",children:[e.jsx(t,{variant:"link",className:`p-0 fs-5 ${s.isFavorite?"text-warning":"text-muted opacity-50"}`,onClick:()=>O(s.id),children:s.isFavorite?e.jsx(Y,{}):e.jsx(q,{})}),e.jsxs("div",{className:"flex-grow-1 min-w-0",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-1",children:[e.jsx("h6",{className:"mb-0 fw-bold text-truncate",children:s.frameworkName}),e.jsx(z,{bg:"secondary",className:"opacity-75",children:s.category})]}),e.jsxs("div",{className:"d-flex align-items-center gap-3 text-muted small",children:[e.jsxs("span",{className:"d-flex align-items-center gap-1",children:[e.jsx(K,{size:10}),new Date(s.versions?.[s.versions?.length-1]?.timestamp??0).toLocaleString()]}),e.jsxs("span",{className:"d-flex align-items-center gap-1",children:[e.jsx(w,{size:10}),s.versions?.length||0," Versi"]})]})]}),e.jsxs("div",{className:"d-flex gap-2 ms-auto",children:[e.jsxs(t,{variant:"primary",size:"sm",onClick:()=>p(s.versions?.[s.versions?.length-1],s),title:"Muat Versi Terbaru",className:"px-3",children:[e.jsx(F,{size:10,className:"me-1"})," Load"]}),e.jsx(t,{variant:"outline-info",size:"sm",onClick:()=>U(s.id),title:"Lihat Riwayat",children:e.jsx(w,{size:12})}),e.jsx(t,{variant:"outline-light",size:"sm",onClick:()=>A(s),title:"Ganti Nama",children:e.jsx(Q,{size:12})}),e.jsx(t,{variant:"outline-success",size:"sm",onClick:()=>$(s),title:"Ekspor JSON",children:e.jsx(k,{size:12})}),e.jsx(t,{variant:"outline-danger",size:"sm",onClick:()=>E(s.id),title:"Hapus",children:e.jsx(W,{size:12})})]})]}),e.jsx(te,{in:b===s.id,children:e.jsxs("div",{className:"mt-3 pt-3 border-top border-secondary border-opacity-25",children:[e.jsx("div",{className:"small text-muted text-uppercase fw-bold mb-2",children:"Riwayat Iterasi"}),e.jsx(R,{variant:"flush",children:s.versions?.map((a,r)=>e.jsxs(R.Item,{className:"bg-transparent border-0 d-flex justify-content-between align-items-center py-2 px-0 small border-bottom border-secondary border-opacity-10",children:[e.jsxs("div",{children:[e.jsxs(z,{bg:"dark",className:"me-2 text-info border border-info border-opacity-25",children:["v",r+1]}),e.jsx("span",{className:"opacity-75",children:new Date(a.timestamp).toLocaleString()})]}),e.jsxs(t,{variant:"link",size:"sm",className:"text-info p-0 text-decoration-none",onClick:()=>p(a,s),children:[e.jsx(F,{size:10,className:"me-1"})," Muat Versi Ini"]})]},r))})]})})]})},s.id))})})]}),e.jsx(d.Footer,{className:"modal-footer-themed bg-dark border-top border-secondary",children:e.jsx(t,{variant:"outline-secondary",onClick:f,className:"px-4",children:"Tutup"})})]})};export{oe as default};
